<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Preis Vergleicher</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>Herzlich Willkomen</h1>
      <button id="testCorsBtn">Test CORS</button>
      <h2></h2>
    </header>

    <main>
      <section>
        <h3>Preis Vergleicher</h3>
        <p id="main_desc">
          Willkommen zum Preis Vergleicher! Hier können Sie die Preise von
          verschiedenen Produkten bei Migros, Coop, Lidl und Aldi vergleichen.
          Geben Sie einfach die Produktnamen ein und klicken Sie auf "Preise
          Vergleichen", um die aktuellen Preise zu sehen.
        </p>
        <h4 id="statusText-test"></h4>
      </section>
      <section id="tabel">
        <table>
          <tr>
            <th>Auswählen</th>
            <th>Produktname</th>
            <th>Migros</th>
            <th>Coop</th>
            <th>Lidl</th>
            <th>Aldi</th>
          </tr>

          <tr>
            <td><input type="checkbox" id="cb_milk" /></td>
            <td>Milch (1lt.)</td>
            <td id="milk_mig"></td>
            <td id="milk_coop"></td>
            <td id="milk_lidl"></td>
            <td id="milk_aldi"></td>
          </tr>
          <tr>
            <td><input type="checkbox" id="cb_bread" /></td>
            <td>Brot (500g)</td>
            <td id="bread_mig"></td>
            <td id="bread_coop"></td>
            <td id="bread_lidl"></td>
            <td id="bread_aldi"></td>
          </tr>
          <tr>
            <td><input type="checkbox" id="cb_eggs" /></td>
            <td>Eier (6 Stück)</td>
            <td id="eggs_mig"></td>
            <td id="eggs_coop"></td>
            <td id="eggs_lidl"></td>
            <td id="eggs_aldi"></td>
          </tr>
        </table>
      </section>
    </main>

    <script>
      const prices = {
        milk: { migros: 1.0, coop: 1.1, lild: 0.95, aldi: 0.9 },
        bread: { migros: 1.5, coop: 1.6, lild: 1.4, aldi: 1.3 },
        eggs: { migros: 3.0, coop: 3.2, lild: 2.8, aldi: 2.7 },
      };
      const cb_milk = document.getElementById("cb_milk");
      const cb_bread = document.getElementById("cb_bread");
      const cb_eggs = document.getElementById("cb_eggs");
      const testCorsBtn = document.getElementById("testCorsBtn");

      const statusText = document.getElementById("statusText-test");
      testCorsBtn.addEventListener("click", corsHandler);
      async function corsHandler() {
        const response = await fetch("http://localhost:3210/api/cors-test");
        const data = await response.json();
        console.log(data);
        statusText.textContent = data.message;
      }

      cb_milk.addEventListener("change", milkHandler);
      async function milkHandler() {
        const response = await fetch("http://localhost:3210/api/select-milk");
        if (cb_milk.checked) {
          console.log("Milch ausgewählt");
          document.getElementById("milk_mig").textContent =
            prices.milk.migros + " CHF";
          document.getElementById("milk_coop").textContent =
            prices.milk.coop + " CHF";
          document.getElementById("milk_lidl").textContent =
            prices.milk.lild + " CHF";
          document.getElementById("milk_aldi").textContent =
            prices.milk.aldi + " CHF";
        } else {
          console.log("Milch nicht ausgewählt");
          document.getElementById("milk_mig").textContent = "";
          document.getElementById("milk_coop").textContent = "";
          document.getElementById("milk_lidl").textContent = "";
          document.getElementById("milk_aldi").textContent = "";
        }
      }

      cb_bread.addEventListener("change", breadHandler);
      async function breadHandler() {
        const response = await fetch("http://localhost:3210/api/select-bread");
        if (cb_bread.checked) {
          document.getElementById("bread_mig").textContent =
            prices.bread.migros + " CHF";
          document.getElementById("bread_coop").textContent =
            prices.bread.coop + " CHF";
          document.getElementById("bread_lidl").textContent =
            prices.bread.lild + " CHF";
          document.getElementById("bread_aldi").textContent =
            prices.bread.aldi + " CHF";
          console.log("Brot ausgewählt");
        } else {
          document.getElementById("bread_mig").textContent = "";
          document.getElementById("bread_coop").textContent = "";
          document.getElementById("bread_lidl").textContent = "";
          document.getElementById("bread_aldi").textContent = "";
          console.log("Brot nicht ausgewählt");
        }
      }

      cb_eggs.addEventListener("change", eggsHandler);
      async function eggsHandler() {
        const response = await fetch("http://localhost:3210/api/select-eggs");
        if (cb_eggs.checked) {
          document.getElementById("eggs_mig").textContent = "3.0 CHF";
          document.getElementById("eggs_coop").textContent =
            prices.eggs.coop + " CHF";
          document.getElementById("eggs_lidl").textContent =
            prices.eggs.lild + " CHF";
          document.getElementById("eggs_aldi").textContent =
            prices.eggs.aldi + " CHF";
          console.log("Eier ausgewählt");
        } else {
          document.getElementById("eggs_mig").textContent = "";
          document.getElementById("eggs_coop").textContent = "";
          document.getElementById("eggs_lidl").textContent = "";
          document.getElementById("eggs_aldi").textContent = "";
          console.log("Eier nicht ausgewählt");
        }
      }
    </script>
  </body>
</html>
